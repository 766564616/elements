<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cdutcm.dao.DoctorDao">

    <resultMap id="doctor" type="com.cdutcm.entity.Doctor">
        <result property="name" column="real_name"/>
    </resultMap>
    <select id="selectDoctor" resultMap="doctor">
        SELECT *
        FROM doctor
        <where>
            <choose>
                <when test="username != null and password != null">
                    username = #{username} AND password = #{password}
                </when>
                <when test="username != null">
                    username = #{username}
                </when>
                <when test="mail != null">
                    mail = #{mail}
                </when>
                <otherwise>
                    1 = 0
                </otherwise>
            </choose>
        </where>
    </select>

    <insert id="insertDoctor" parameterType="com.cdutcm.entity.Doctor">
        INSERT INTO doctor (username, password, real_name, mail, state)
        VALUES (#{username}, #{password}, #{name}, #{mail}, 0);
    </insert>

    <update id="updateDoctor">
        UPDATE doctor
        <set>
            <if test="doctor.password != null">
                password = #{doctor.password}
            </if>
            <if test="doctor.state != null">
                state = #{doctor.state}
            </if>
            <if test="newMail != null">
                mail = #{newMail}
            </if>
        </set>
        WHERE mail = #{doctor.mail};
    </update>
</mapper>