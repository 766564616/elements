<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cdutcm.dao.CategoryDao">
    <select id="selectCategory" resultType="com.cdutcm.entity.Category">
        SELECT * FROM category
        <where>
            <if test="phone != null">phone = #{phone}</if>
            <if test="name != null and phone == null">
                AND phone = (select phone from conclusion WHERE real_name = #{name} LIMIT 1);
            </if>
        </where>
    </select>

    <insert id="saveCategory" parameterType="com.cdutcm.entity.Category" useGeneratedKeys="true">
        INSERT INTO category (phone, feature, complexion, trunk, limb, voice, psychology, disease)
        VALUES (#{phone}, #{feature}, #{complexion}, #{trunk}, #{limb}, #{voice}, #{psychology}, #{disease});
    </insert>

    <update id="updateCategory" parameterType="com.cdutcm.entity.Category">
        UPDATE category
        SET feature = #{feature}, complexion = #{complexion}, trunk = #{trunk}, limb = #{limb},
            voice   = #{voice}, psychology = #{psychology}, disease = #{disease}
        WHERE phone = #{phone};
    </update>

    <delete id="deleteCategory" parameterType="java.lang.String">
        DELETE FROM category WHERE phone = #{phone};
    </delete>
</mapper>
